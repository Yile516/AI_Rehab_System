{% extends "base.html" %}

{% block content %}
<div class="split-layout fade-in">

    <!-- LEFT: Video Section -->
    <div class="video-section-left">
        <video controls autoplay loop playsinline muted>
            <source src="{{ url_for('get_result_video', filename=video) }}" type="video/mp4">
            您的瀏覽器不支援影片播放。
        </video>
        <!-- Overlay Re-test Button -->
        <a href="/" class="btn"
            style="position: absolute; bottom: 20px; right: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.5);">
            <i class="fas fa-redo"></i> 再次檢測
        </a>
    </div>

    <!-- RIGHT: Info Panel -->
    <div class="info-panel-right">

        <!-- TOP: Diagnosis Cards (Risk Identification) -->
        <div class="diagnosis-top" style="border-left: 6px solid {{ info.color }};">
            <div style="display: flex; justify-content: space-between; width: 100%; align-items: center;">
                <div class="status-stamp" style="color: {{ info.color }};">
                    {{ info.status }}
                </div>
                <!-- AI Tag aligned to right -->
                <div style="color: var(--text-muted); font-size: 0.9rem;">
                    <i class="fas fa-file-medical-alt"></i> AI 智能診斷
                </div>
            </div>

            <div class="diagnosis-desc">
                {{ info.desc }}
            </div>
        </div>

        <!-- BOTTOM: Metrics List (Vertical Stack) -->
        <div class="metrics-bottom">
            <h3
                style="margin-left: 0.5rem; color: var(--text-secondary); font-size: 1rem; text-transform: uppercase; letter-spacing: 2px;">
                生物力學指標 (Biomechanics)
            </h3>

            <!-- Metric 1 -->
            <div class="metric-card-row"
                style="border-left-color: {{ 'var(--accent-error)' if features.X1_MaxTrunkLean > 45 else 'var(--accent-success)' }};">
                <div class="metric-icon"><i class="fas fa-ruler-vertical"></i></div>
                <div class="metric-label">最大軀幹前傾</div>
                <div class="metric-value">{{ "%.1f"|format(features.X1_MaxTrunkLean) }}°</div>
            </div>

            <!-- Metric 2 -->
            <div class="metric-card-row"
                style="border-left-color: {{ 'var(--accent-error)' if features.X3_MinHandKneeDist < 0.2 else 'var(--accent-success)' }};">
                <div class="metric-icon"><i class="fas fa-arrows-alt-h"></i></div>
                <div class="metric-label">手膝最小距離</div>
                <div class="metric-value">{{ "%.2f"|format(features.X3_MinHandKneeDist) }}</div>
            </div>

            <!-- Metric 3 -->
            <div class="metric-card-row" style="border-left-color: var(--accent-primary);">
                <div class="metric-icon"><i class="fas fa-stopwatch"></i></div>
                <div class="metric-label">動作總時長</div>
                <div class="metric-value">{{ "%.2f"|format(features.X2_TotalDuration) }} s</div>
            </div>

            <!-- Metric 4 -->
            <div class="metric-card-row" style="border-left-color: var(--accent-primary);">
                <div class="metric-icon"><i class="fas fa-angle-right"></i></div>
                <div class="metric-label">結束膝蓋角度</div>
                <div class="metric-value">{{ "%.1f"|format(features.X4_EndKneeAngle) }}°</div>
            </div>

        </div>

    </div>

</div>
{% endblock %}